var StockGenerator={init:function(){this.GetStocks(this.GetLocalTickers());},GetLocalTickers:function(){var c=["GOOG","EVHC","YHOO","AAPL","FB","MMM"],a=[],b="";if(typeof localStorage.LocalTickers=="undefined"){localStorage.LocalTickers=JSON.stringify(c);}a=JSON.parse(localStorage.LocalTickers);return a;},AddLocalTicker:function(a){LocalTickers=JSON.parse(localStorage.LocalTickers);if(LocalTickers.indexOf(a)==-1){LocalTickers.push(a);localStorage.LocalTickers=JSON.stringify(LocalTickers);this.DestroyTickersContainer();this.GetStocks(this.GetLocalTickers());}},RemoveLocalTicker:function(a){LocalTickers=JSON.parse(localStorage.LocalTickers);i=LocalTickers.indexOf(a);if(i!=-1){LocalTickers.splice(i,1);localStorage.LocalTickers=JSON.stringify(LocalTickers);}},GetStocks:function(a){for(i in a){this.GetStock(a[i]);}},GetStock:function(c){var a="http://dev.markitondemand.com/Api/Quote/jsonp?symbol="+c;var b=new XMLHttpRequest();b.open("GET",a);b.onload=function(f){var d=f.currentTarget.responseText.split("(function () { })(")[1];d=d.slice(0,d.length-1);StockGenerator.AddTickerToContainer(d);};b.send(null);},AddTickerToContainer:function(c){var b=document.getElementById("TickersContainer");if(typeof o=="undefined"){var a=document.createElement("div");a.id="TickersContainer";document.body.appendChild(a);b=document.getElementById("TickersContainer");}o=JSON.parse(c);q=o.Data;var f=document.createElement("div");f.className="QuoteItem";f.setAttribute("ticker",q.Symbol);f.appendChild(this.CreateDOMElement("div","ticker",q.Symbol));f.appendChild(this.CreateDOMElement("div","LastTradePrice",q.LastPrice.toFixed(2)));var h="ChangeInPercent";if(parseFloat(q.ChangePercent.toFixed(3))==0){h+=" gray";}else{if(parseFloat(q.ChangePercent.toFixed(3))>0){h+=" green";}else{h+=" red";}}var g=((q.Change.toFixed(3)>0&&q.Change.toFixed(3)<0.01)||(q.Change.toFixed(3)<0&&q.Change.toFixed(3)>-0.01)?q.Change.toFixed(3):q.Change.toFixed(2));var d=((q.ChangePercent.toFixed(3)>0&&q.ChangePercent.toFixed(3)<0.01)||(q.ChangePercent.toFixed(3)<0&&q.ChangePercent.toFixed(3)>-0.01)?q.ChangePercent.toFixed(3):q.ChangePercent.toFixed(2));f.appendChild(this.CreateDOMElement("div",h,(parseFloat(d)>0?"+":"")+g+" ( "+(parseFloat(d)>0?"+":"")+d+"% ) "));var e=this.CreateDOMElement("img");e.setAttribute("ticker",q.Symbol);e.src="icon_remove.png";e.width=15;e.onclick=function(){this.parentNode.parentNode.parentNode.removeChild(this.parentNode.parentNode);StockGenerator.RemoveLocalTicker(this.getAttribute("ticker"));};var j=this.CreateDOMElement("div","cancel");j.appendChild(e);f.appendChild(j);b.appendChild(f);StockGenerator.SortTickersContainer();},SortTickersContainer:function(){var a=document.getElementById("TickersContainer");var c=a.childNodes;var b=[];for(i in c){if(c[i].nodeType==1){b.push(c[i]);}}b.sort(function(e,d){return e.innerHTML==d.innerHTML?0:(e.innerHTML>d.innerHTML?1:-1);});for(i in b){a.appendChild(b[i]);}},DestroyTickersContainer:function(){document.body.removeChild(document.getElementById("TickersContainer"));
},CreateDOMElement:function(a,c,b){var d=document.createElement(a);if(typeof c!="undefined"){d.className=c;}if(typeof b!="undefined"){d.innerHTML=b;}return d;}};document.addEventListener("DOMContentLoaded",function(){StockGenerator.init();});