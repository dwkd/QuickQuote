var StockGenerator={init:function(){this.GetStocks(this.GetLocalTickers());},GetLocalTickers:function(){var c=["GOOG","EVHC","YHOO","AAPL","FB","MMM"],a=[],b="";if(typeof localStorage.LocalTickers=="undefined"){localStorage.LocalTickers=JSON.stringify(c);}a=JSON.parse(localStorage.LocalTickers);return a;},AddLocalTicker:function(a){LocalTickers=JSON.parse(localStorage.LocalTickers);if(LocalTickers.indexOf(a)==-1){LocalTickers.push(a);localStorage.LocalTickers=JSON.stringify(LocalTickers);this.DestroyTickersContainer();this.GetStocks(this.GetLocalTickers());}},RemoveLocalTicker:function(a){LocalTickers=JSON.parse(localStorage.LocalTickers);i=LocalTickers.indexOf(a);if(i!=-1){LocalTickers.splice(i,1);localStorage.LocalTickers=JSON.stringify(LocalTickers);}},GetStocks:function(a){for(i in a){this.GetStock(a[i]);}},GetStock:function(c){var a="http://dev.markitondemand.com/Api/Quote/jsonp?symbol="+c;var b=new XMLHttpRequest();b.open("GET",a);b.onload=function(f){var d=f.currentTarget.responseText.split("(function () { })(")[1];d=d.slice(0,d.length-1);StockGenerator.AddTickerToContainer(d);};b.send(null);},AddTickerToContainer:function(c){var d=document.getElementById("TickersContainer");if(typeof o=="undefined"){var g=document.createElement("div");g.id="TickersContainer";document.body.appendChild(g);d=document.getElementById("TickersContainer");}o=JSON.parse(c);q=o.Data;var e=document.createElement("div");e.className="QuoteItem";e.setAttribute("ticker",q.Symbol);e.appendChild(this.CreateDOMElement("div","ticker",q.Symbol));e.appendChild(this.CreateDOMElement("div","LastTradePrice",q.LastPrice.toFixed(2)));var b="ChangeInPercent";if(parseFloat(q.ChangePercent)==0){b+=" gray";}else{if(parseFloat(q.ChangePercent)>0){b+=" green";}else{b+=" red";}}e.appendChild(this.CreateDOMElement("div",b,q.Change.toFixed(2)+" ( "+(parseFloat(q.ChangePercent)>0?"+":"")+q.ChangePercent.toFixed(2)+"% ) "));var a=this.CreateDOMElement("img");a.setAttribute("ticker",q.Symbol);a.src="icon_remove.png";a.width=15;a.onclick=function(){this.parentNode.parentNode.parentNode.removeChild(this.parentNode.parentNode);StockGenerator.RemoveLocalTicker(this.getAttribute("ticker"));};var f=this.CreateDOMElement("div","cancel");f.appendChild(a);e.appendChild(f);d.appendChild(e);StockGenerator.SortTickersContainer();},SortTickersContainer:function(){var a=document.getElementById("TickersContainer");var c=a.childNodes;var b=[];for(i in c){if(c[i].nodeType==1){b.push(c[i]);}}b.sort(function(e,d){return e.innerHTML==d.innerHTML?0:(e.innerHTML>d.innerHTML?1:-1);});for(i in b){a.appendChild(b[i]);}},DestroyTickersContainer:function(){document.body.removeChild(document.getElementById("TickersContainer"));},CreateDOMElement:function(a,c,b){var d=document.createElement(a);if(typeof c!="undefined"){d.className=c;}if(typeof b!="undefined"){d.innerHTML=b;}return d;}};document.addEventListener("DOMContentLoaded",function(){StockGenerator.init();});